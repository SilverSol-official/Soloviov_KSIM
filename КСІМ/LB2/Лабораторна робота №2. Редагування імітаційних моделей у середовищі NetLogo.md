

**Варіант:** Модифікація моделі **Virus Basic** (SIR-модель, агенти: **turtles**).

## Опис Внесених Змін до Вихідної Логіки Моделі

### 1. Зміни згідно з Варіантом (Обов'язкові)

#### А. Вплив Віку на Інфікування та Результат Захворювання
Реалізовано диференційований вплив віку (`age`) агента на його вразливість. Модифікатори додаються до базових параметрів `infectiousness` та `chance-recover` в залежності від того, чи є агент молодим (до 20% життя) чи літнім (понад 75% життя).

* **Літні агенти ($\text{age} > 75\%\text{ lifespan}$):** +10 до шансу інфікування, -10 до шансу одужання.
* **Молоді агенти ($\text{age} < 20\%\text{ lifespan}$):** -5 до шансу інфікування, +5 до шансу одужання.

  **Фрагмент коду (процедура `infect`):**
```netlogo
  let age-modifier 0
  if age > (lifespan * 0.75) [ set age-modifier 10 ]   ;; +10% вразливості для літніх
  if age < (lifespan * 0.2) [ set age-modifier -5 ]     ;; -5% вразливості для молодих
    
  let effective-infectiousness infectiousness + age-modifier
```
  **Фрагмент коду (процедура `recover-or-die`):**
```netlogo
 let age-factor 0
    if age > (lifespan * 0.75) [ set age-factor -10 ]   ;; -10% шансу одужати для літніх
    if age < (lifespan * 0.2) [ set age-factor 5 ]      ;; +5% шансу одужати для молодих
```
#### Б. Вплив Поширення Хвороби на Народжуваність
Впроваджено механізм, де високий рівень поширення вірусу (`%infected`) негативно впливає на народжуваність, моделюючи соціальну чи біологічну реакцію популяції на кризу.

* **Реалізація:** Шанс розмноження (`chance-reproduce`) зменшується на $\frac{\%\text{infected}}{2}$ у кожному такті.

   **Фрагмент коду (процедура `reproduce`):**
```netlogo
to reproduce
  let spread-reduction %infected / 2   ;; Зменшення шансу народження на половину від % хворих
  let final-reproduce-chance chance-reproduce - spread-reduction
  
  if final-reproduce-chance < 0 [ set final-reproduce-chance 0 ]
  
  if count turtles < carrying-capacity and random-float 100 < final-reproduce-chance [
    hatch 1 [ ... ]
  ]
end
``` 

#### В. Регулювання Імунітету та Повторного Зараження
Введено нові параметри для гнучкого налаштування епідемічного циклу $\text{S} \to \text{I} \to \text{R} \to \text{S}$:
* **`immunity-duration`:** Керує, як довго агент залишається імунним.
* **`ever-sick?`:** Змінна агента, яка фіксує попереднє захворювання.
* **`reinfect-multiplier`:** Слайдер (0-100), який визначає, наскільки **знижується** сприйнятливість до повторного зараження для агента, що вже перехворів.
  
**Використано прапорець `ever-sick?` та слайдер `reinfect-multiplier`:**
```netlogo
if ever-sick? [
        set final-infection-chance final-infection-chance * (reinfect-multiplier / 100)
      ]
```

#### Г. Впровадження адаптивного карантину (Behavioral Response)
Реалізовано динамічну зміну стратегії пересування агентів залежно від поточного рівня загрози в популяції.
* **Механіка:** Агенти аналізують глобальну змінну `%infected` у кожному такті симуляції.
* **Логіка зміни:** Якщо рівень зараження перевищує встановлений поріг у **15%**, швидкість руху агентів (`step-size`) автоматично зменшується з **1.0** до **0.3**.
* **Обґрунтування:** Дана модифікація моделює запровадження адміністративних карантинних обмежень або добровільне соціальне дистанціювання громадян. Зменшення мобільності знижує частоту контактів між агентами на спільних ділянках (patches), що дозволяє досягти ефекту "плато" (flattening the curve).

**Зміна логіки руху агентів залежно від глобальної змінної `%infected`:**
```netlogo
to move
  ;; Якщо інфіковано більше 15%, швидкість падає з 1.0 до 0.3
  let step-size ifelse-value (%infected > 15) [ 0.3 ] [ 1.0 ]
    
  rt random 100
  lt random 100
  fd step-size
end
```

#### Д. Накопичувальне виснаження організму (Cumulative Exhaustion)
Для дослідження довгострокової летальності та наслідків множинних хвиль пандемії введено параметр "історії хвороби" для кожного окремого агента.
* **Механіка:** Кожному агенту додано нову внутрішню змінну-лічильник `infection-count`, яка фіксує кількість перенесених захворювань за весь період життя.
* **Логіка зміни:** Починаючи з другого випадку захворювання, базовий шанс агента на одужання (`chance-recover`) прогресивно знижується на **5%** за кожну попередню хворобу.
* **Математична реалізація:** $$final\_recover\_chance = base\_chance + age\_factor + (infection\_count - 1) \times (-5)$$
* **Обґрунтування:** Модифікація дозволяє дослідити сценарії, де повторні зараження поступово виснажують імунну систему та ресурси організму, що призводить до зростання смертності серед тих, хто хворіє неодноразово.

**Використано лічильник `infection-count` для зниження шансів на виживання при реінфекції.:**
```netlogo
;; Кожна наступна хвороба після першої знижує шанс одужати на 5%
    let exhaustion-factor (infection-count - 1) * -5
    let final-recover-chance chance-recover + age-factor + exhaustion-factor
        
    ifelse random-float 100 < final-recover-chance     
      [ become-immune ]  
      [ die ]
```

### 2. Зміни у Моніторингу 
Додано монітори для збору ключових показників епідемії:
* **`max-infected-count`** (Кількість агентів на піку).
* **`cumulative-recovered-total`** (Загальна кількість агентів, що перехворіла за весь час).

---

## Обчислювальний Експеримент 

**Мета:** Дослідження впливу множника повторного зараження (`reinfect-multiplier`) на динаміку епідемії за умов функціонування адаптивного карантину та механізму накопичувального виснаження імунітету.

**Фіксовані параметри:** `infectiousness` = 50%, `chance-recover` = 70%, `duration` = 10, `immunity-duration` = 52.
**Поріг карантину:** 15% інфікованих (автоматичне зниження швидкості руху з 1.0 до 0.3).

### Результати експерименту (середнє за 5 прогонів)

| reinfect-multiplier (%) | Середнє Max Infected (Пік) | Середнє Cumulative Recovered (Загалом) |
| :---: | :---: | :---: |
| **0** | **15,8** | **13,0** |
| **25** | **17,0** | **13,4** |
| **50** | **15,4** | **13,2** |
| **75** | **15,2** | **12,0** |
| **100** | **17,2** | **13,8** |


### Аналіз та висновки експерименту:

1. **Ефективність карантинних заходів:** Отримані дані демонструють високу ефективність адаптивного карантину. Незважаючи на збільшення ймовірності повторного зараження, показник `Max Infected` стабільно утримується в межах **15.2–17.2**. Це свідчить про те, що як тільки кількість хворих наближається до порогу 15%, сповільнення агентів ефективно зупиняє подальше вибухове поширення вірусу.

2. **Вплив на сумарну кількість одужалих:** Показник `Cumulative Recovered` залишається відносно низьким і стабільним (в межах **12–14**). Це пояснюється тим, що карантин не дає хворобі охопити велику кількість агентів одночасно, а введений механізм **виснаження імунітету** обмежує кількість успішних повторних одужань.

3. **Загальний висновок:** Модифікована модель довела, що поєднання індивідуальних біологічних факторів (виснаження організму) та колективних заходів (карантин) дозволяє ефективно контролювати епідемію навіть за умови високої ймовірності реінфекції. Система стає саморегульованою: сплеск захворюваності автоматично викликає реакцію, що пригнічує подальше зараження.

---

**Фіналізація:** Фінальний код моделі та її інтерфейс: 

turtles-own  
  [ sick?                ;; якщо true, агент заразний
    remaining-immunity   ;; скільки тижнів імунітету залишилося
    sick-time            ;; тривалість хвороби в тижнях
    age                  ;; вік агента в тижнях
    ever-sick?           ;; чи був агент хворий раніше
    infection-count ]    ;; НОВА: кількість перенесених хвороб (для виснаження)

globals  
  [ %infected            ;; % інфікованих у популяції
    %immune              ;; % імунних у популяції
    lifespan             ;; тривалість життя (тижні)
    chance-reproduce     ;; ймовірність розмноження
    carrying-capacity    ;; ліміт популяції
      
    max-infected-count   ;; найвище значення інфікованих
    final-recovered-count ;; одужали на кінець епідемії
    epidemic-over?        ;; статус завершення
    cumulative-recovered-total ;; загальна кількість одужань за весь час
    duration-of-epidemy   ;; час до піку
    tick-count ]          ;; лічильник часу

;; --- Налаштування моделі ---
to setup
  clear-all
  set max-infected-count 0   
  set final-recovered-count 0   
  set epidemic-over? false     
  set cumulative-recovered-total 0
  set tick-count 0
  set duration-of-epidemy 0
  setup-constants
  setup-turtles
  update-global-variables
  update-display
  reset-ticks
end

to setup-constants
  set lifespan 50 * 52        ;; 50 років
  set carrying-capacity 300   ;;
  set chance-reproduce 1      ;;
end

to setup-turtles
  create-turtles number-people
    [ setxy random-xcor random-ycor
      set age random lifespan
      set sick-time 0
      set remaining-immunity 0
      set size 1.5
      set ever-sick? false
      set infection-count 0
      get-healthy ]
  ask n-of 10 turtles [ get-sick ]
end

;; --- Основний цикл ---
to go
  ;; Виправлена умова зупинки: використовуємо (ticks) та дужки для логіки
  if (all? turtles [not sick?]) and (ticks > 300) [ stop ] 

  ask turtles [
    get-older
    move
    if sick? [ recover-or-die ]
    ifelse sick? [ infect ] [ reproduce ]
  ]
  
  set tick-count tick-count + 1
  let current-infected count turtles with [sick?]
    
  ;; Оновлення статистики піку
  if current-infected > max-infected-count [
    set max-infected-count current-infected   
    set duration-of-epidemy tick-count   
  ]
    
  ;; Фіксація кінця епідемії
  let current-recovered count turtles with [ immune? ]
  if (current-infected = 0) and (not epidemic-over?) [
    set final-recovered-count current-recovered   
    set epidemic-over? true                       
  ]
    
  update-global-variables
  update-display
  tick
end

;; --- Процедури агентів ---

to get-older ;; turtle procedure
  set age age + 1
  if age > lifespan [ die ]
  if immune? [ set remaining-immunity remaining-immunity - 1 ]
  if sick? [ set sick-time sick-time + 1 ]
end

to move ;; turtle procedure
  ;; МОДИФІКАЦІЯ 1: Адаптивний карантин
  ;; Якщо хворих більше 15%, агенти сповільнюються (соціальна дистанція)
  let step-size ifelse-value (%infected > 15) [ 0.3 ] [ 1.0 ]
    
  rt random 100
  lt random 100
  fd step-size
end

to get-sick ;; turtle procedure
  set sick? true
  set remaining-immunity 0
  set ever-sick? true
  set infection-count infection-count + 1 ;; Рахуємо кожне зараження
end

to get-healthy ;; turtle procedure
  set sick? false
  set remaining-immunity 0
  set sick-time 0
end

to become-immune ;; turtle procedure
  set sick? false
  set sick-time 0
  set remaining-immunity immunity-duration
  set cumulative-recovered-total cumulative-recovered-total + 1
end

to infect ;; turtle procedure
  let age-modifier 0
  
  ;; Вплив віку на вразливість
  if age > (lifespan * 0.75) [ set age-modifier 10 ]   
  if age < (lifespan * 0.2) [ set age-modifier -5 ]     
    
  let effective-infectiousness infectiousness + age-modifier
  
  ask other turtles-here with [ not sick? and not immune? ]
    [ let final-infection-chance effective-infectiousness
      
      ;; Вплив повторного зараження через мультиплікатор
      if ever-sick? [
        set final-infection-chance final-infection-chance * (reinfect-multiplier / 100)
      ]
      
      if random-float 100 < final-infection-chance [ get-sick ]
    ]
end

to recover-or-die ;; turtle procedure
  if sick-time > duration [
    let age-factor 0
    
    ;; Вплив віку на одужання
    if age > (lifespan * 0.75) [ set age-factor -10 ]
    if age < (lifespan * 0.2) [ set age-factor 5 ]
        
    ;; МОДИФІКАЦІЯ 3: Накопичувальне виснаження імунітету
    ;; Кожна наступна хвороба знижує шанс одужати на 5%
    let exhaustion-factor (infection-count - 1) * -5
    let final-recover-chance chance-recover + age-factor + exhaustion-factor
        
    ifelse random-float 100 < final-recover-chance     
      [ become-immune ]  
      [ die ]
  ]
end

to reproduce ;; turtle procedure
  ;; Вплив поширення вірусу на народжуваність
  let spread-reduction %infected / 2   
  let final-reproduce-chance chance-reproduce - spread-reduction
  
  if final-reproduce-chance < 0 [ set final-reproduce-chance 0 ]
    
  if count turtles < carrying-capacity and random-float 100 < final-reproduce-chance [
    hatch 1 [
      set age 1
      set infection-count 0
      set ever-sick? false
      lt 45 fd 1
      get-healthy
    ]
  ]
end

;; --- Репортери та відображення ---

to-report immune?
  report remaining-immunity > 0
end

to update-global-variables
  if count turtles > 0 [
    set %infected (count turtles with [ sick? ] / count turtles) * 100
    set %immune (count turtles with [ immune? ] / count turtles) * 100
  ]
end

to update-display
  ask turtles [
    set shape "person"
    set color ifelse-value sick? [ red ] [ ifelse-value immune? [ grey ] [ green ] ]
  ]
end


![screen lb2](https://github.com/SilverSol-official/Soloviov_KSIM/blob/main/%D0%9A%D0%A1%D0%86%D0%9C/LB2/Pasted%20image%2020251129215142.png)
